<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ·±å…¥æµ…å‡ºreact-redux-middleware | å®ˆå¤œäººç¬”è®°</title>
    <meta name="description" content="å®ˆå¤œäººç¬”è®°">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="/img/favicon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.f09e5b7a.css" as="style"><link rel="preload" href="/assets/js/app.903983bb.js" as="script"><link rel="preload" href="/assets/js/2.c5c844f9.js" as="script"><link rel="preload" href="/assets/js/18.ceef7e7d.js" as="script"><link rel="preload" href="/assets/js/10.acc61093.js" as="script"><link rel="prefetch" href="/assets/js/11.b5b7d313.js"><link rel="prefetch" href="/assets/js/12.044e77b3.js"><link rel="prefetch" href="/assets/js/13.f84ff47d.js"><link rel="prefetch" href="/assets/js/14.4f25373e.js"><link rel="prefetch" href="/assets/js/15.69ad7253.js"><link rel="prefetch" href="/assets/js/16.ac264240.js"><link rel="prefetch" href="/assets/js/17.8684da05.js"><link rel="prefetch" href="/assets/js/19.fdccf963.js"><link rel="prefetch" href="/assets/js/20.eea2ef94.js"><link rel="prefetch" href="/assets/js/21.436a904b.js"><link rel="prefetch" href="/assets/js/22.5b0e4632.js"><link rel="prefetch" href="/assets/js/23.456132eb.js"><link rel="prefetch" href="/assets/js/24.0c9dfbdb.js"><link rel="prefetch" href="/assets/js/25.1e46f166.js"><link rel="prefetch" href="/assets/js/26.bc6d72fe.js"><link rel="prefetch" href="/assets/js/27.699fbdd0.js"><link rel="prefetch" href="/assets/js/28.b4423e59.js"><link rel="prefetch" href="/assets/js/3.b94df1a7.js"><link rel="prefetch" href="/assets/js/4.29bcc168.js"><link rel="prefetch" href="/assets/js/5.a332531e.js"><link rel="prefetch" href="/assets/js/6.a34f260f.js"><link rel="prefetch" href="/assets/js/7.b152462c.js"><link rel="prefetch" href="/assets/js/8.6811b85d.js"><link rel="prefetch" href="/assets/js/9.a9a41e29.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f09e5b7a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">å®ˆå¤œäººç¬”è®°</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  home
</a></div><div class="nav-item"><a href="/FAQ/" class="nav-link router-link-active">
  æ±‚ç´¢
</a></div><div class="nav-item"><a href="/Thought/" class="nav-link">
  éšç¬”
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/StackFei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHubé¦–é¡µ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  home
</a></div><div class="nav-item"><a href="/FAQ/" class="nav-link router-link-active">
  æ±‚ç´¢
</a></div><div class="nav-item"><a href="/Thought/" class="nav-link">
  éšç¬”
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/StackFei" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHubé¦–é¡µ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/FAQ/" class="sidebar-link">ğŸ“šJSæ‰‹æ®‹</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>èŠ±é‡Œèƒ¡å“¨å¿…å¤‡ç‚¹</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/FAQ/ES/promise.html" class="sidebar-link">ğŸš—promise</a></li><li><a href="/FAQ/ES/react-window.html" class="sidebar-link">ğŸš•é•¿åˆ—è¡¨</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Reactä¸­çš„ä¸€äº›å°å¿ƒå¾—</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/FAQ/React/VirtualDom.html" class="sidebar-link">ğŸŒ°ç®€å•çš„è™šæ‹ŸDom</a></li><li><a href="/FAQ/React/react-router.html" class="sidebar-link">ğŸ‘router</a></li><li><a href="/FAQ/React/context.html" class="sidebar-link">ğŸ‡ä¸Šä¸‹æ–‡</a></li><li><a href="/FAQ/React/react-redux.html" class="sidebar-link">ğŸreduxçš„é€šè®¯æ–¹å¼</a></li><li><a href="/FAQ/React/react-redux-middleware.html" class="active sidebar-link">ğŸç®€æ˜“ä¸­é—´ä»¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/FAQ/React/react-redux-middleware.html#å‰ç½®çŸ¥è¯†" class="sidebar-link">å‰ç½®çŸ¥è¯†</a></li><li class="sidebar-sub-header"><a href="/FAQ/React/react-redux-middleware.html#redux-logger" class="sidebar-link">redux-logger</a></li><li class="sidebar-sub-header"><a href="/FAQ/React/react-redux-middleware.html#redux-thunk" class="sidebar-link">redux-thunk</a></li><li class="sidebar-sub-header"><a href="/FAQ/React/react-redux-middleware.html#redux-promise" class="sidebar-link">redux-promise</a></li><li class="sidebar-sub-header"><a href="/FAQ/React/react-redux-middleware.html#compose" class="sidebar-link">compose</a></li></ul></li><li><a href="/FAQ/React/Hooks.html" class="sidebar-link">ğŸŠHooks</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vueçš„ä¸€äº›å°ç¬”è®°</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/FAQ/Vue/Cli.html" class="sidebar-link">ğŸ”¨èŠ±é‡Œèƒ¡å“¨çš„cli</a></li><li><a href="/FAQ/Vue/observer.html" class="sidebar-link">ğŸ”§ä¹ä¸ç‰ˆæœ¬MvvM</a></li><li><a href="/FAQ/Vue/Communication.html" class="sidebar-link">ğŸ› ï¸è®°ä¸€æ¬¡é€šä¿¡æ–¹å¼</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ—¥å¸¸æ‚ç©</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/FAQ/Work/TSC.html" class="sidebar-link">ğŸ‹ï¸â€â™‚ï¸TypeScript</a></li><li><a href="/FAQ/Work/cicd.html" class="sidebar-link">ğŸš´æŒç»­é›†æˆéƒ¨ç½²ï¼ˆci/cdï¼‰</a></li><li><a href="/FAQ/Work/AOP.html" class="sidebar-link">ğŸŒï¸â€â™‚ï¸AOPé¢å‘åˆ‡ç‰‡ç¼–ç¨‹</a></li><li><a href="/FAQ/Work/WeChat.html" class="sidebar-link">â›¹ï¸è¸©å‘Reactç³»åˆ—å°ç¨‹åº</a></li><li><a href="/FAQ/Work/Work1.html" class="sidebar-link">ğŸ¤¾â€â™‚ï¸å‰ç«¯è¯·æ±‚çš„æ­£ç¡®æ‰“å¼€æ–¹å¼</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ä¹±å†™ç³»åˆ—</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/FAQ/Node/require.html" class="sidebar-link">ğŸ€requireåŸºæ“</a></li><li><a href="/FAQ/Node/Koa.html" class="sidebar-link">âš½ï¸åˆçº§Koa</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p><code>react-redux</code>æ ¸å¿ƒç³»åˆ—ç»„ä»¶å·²ç»è¿‡çš„å·®ä¸å¤šäº†, æ¥ä¸‹é‡Œè¯¥ç¢°ä¸€ç¢°å‘¨è¾¹äº†, <code>middleware</code> å¾ˆç†Ÿæ‚‰çš„åè¯, æ²¡é”™<code>Node</code>ç³»åˆ—éƒ½æ˜¯é ä»–åƒé¥­, æ¥ä¸‹é‡Œå°†å°è¯•æ“ä¸€æ“<code>redux</code>ä¸­é—´ä»¶, å…¶å®å¤§éƒ¨åˆ†æ²¡ä»€ä¹ˆéš¾åº¦, ä¸»è¦å°±æ˜¯èµ·åˆ°è¿‡æ»¤æœåŠ¡,è€è§„çŸ©, å­¦ä¹ è®°å½•, é«˜æ‰‹å‹¿æ‰°.</p></blockquote> <h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="header-anchor">#</a> å‰ç½®çŸ¥è¯†</h2> <p>ç»“æœå‰é¢çš„å­¦ä¹ , é»˜è®¤å¤§å®¶éƒ½ç†Ÿç»ƒä½¿ç”¨<code>redux</code>ç³»åˆ—ç»„ä»¶, å…ˆå­¦ä¼šç”¨å†å­¦ä¼šå…¶åŸç†, è¿™æ˜¯ä¸€ä¸ªè¿‡ç¨‹, ä¸‹é¢æ¥å‰–æ<code>redux</code>ä¸­é—´ä»·, é¡¾åæ€ä¹‰, èµ·åˆ°ä¸­é—´è¿‡æ»¤ä½œç”¨. éœ€è¦æ³¨æ„çš„æ˜¯, ä¸­é—´ä»¶åªæ‹¦æˆªè‡ªå·±èƒ½è§£å†³çš„é—®é¢˜, æ— æ³•è§£å†³ç›´æ¥<code>next</code>æŠ›åˆ°ä¸‹ä¸€ä¸ªä¸­é—´ä»¶, ä¸‹é¢æˆ‘ä»¬å°†ç”±æµ…è‡³æ·±, åˆ†åˆ«å‰–æå¸¸ç”¨çš„ä¸­é—´ä»· <strong><code>redux-logger</code>, <code>redux-thunk</code>, <code>redux-promise</code>, å·²ç»å¯èƒ½ä¼šç”¨åˆ°çš„ç¼“å­˜ä¸­é—´ä»¶<code>redux-persist</code></strong></p> <table><thead><tr><th>åç§°</th> <th>ä½œç”¨</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td><span class="badge tip" style="vertical-align:top;" data-v-26ebd6a3>redux-logger</span></td> <td>è®°å½•æ“ä½œæ—¥å¿—</td> <td>ğŸš€</td></tr> <tr><td><span class="badge tip" style="vertical-align:top;" data-v-26ebd6a3>redux-thunk</span></td> <td>è®©<code>createStore</code>æ”¯æŒä¸­é—´ä»¶æ“ä½œ</td> <td>ğŸš€</td></tr> <tr><td><span class="badge tip" style="vertical-align:top;" data-v-26ebd6a3>redux-promise</span></td> <td>å¯ä»¥æ´¾å‘ä¸ä»…é™äº<code>function</code>çš„<code>promise</code></td> <td>ğŸš€</td></tr> <tr><td><span class="badge tip" style="vertical-align:top;" data-v-26ebd6a3>redux-persist</span></td> <td>ç¼“å­˜éœ€è¦æŒä¹…åŒ–å­˜åœ¨çš„æ•°æ®</td> <td>ğŸš€</td></tr> <tr><td><span class="badge tip" style="vertical-align:top;" data-v-26ebd6a3>redux-actions</span></td> <td>ç®€åŒ–åˆå¹¶<code>actions</code>åŠ¨ä½œ</td> <td>äº†è§£å³å¯</td></tr> <tr><td><span class="badge tip" style="vertical-align:top;" data-v-26ebd6a3>............</span></td> <td>..............</td> <td>äº†è§£å³å¯</td></tr></tbody></table> <blockquote><p><strong>è®°ä½ä¸€ä¸ªåŸåˆ™, ä¸­é—´ä»¶å°±æ˜¯ä¸€ä¸ªè¿‡æ»¤çš„å‡½,æ¯ä¸€ä¸ªå‡½æ•°éƒ½è¿”å›ä¸‹ä¸€ä¸ªå‡½æ•°ä»¥åŠç»“æœ</strong></p></blockquote> <h2 id="redux-logger"><a href="#redux-logger" class="header-anchor">#</a> redux-logger <span class="badge tip" style="vertical-align:top;" data-v-26ebd6a3>éš¾åº¦ç³»æ•°ğŸŒŸ</span></h2> <p>ä½¿ç”¨<code>react-redux</code>çš„ç¡®æ˜¯ä¸€ç§å¾ˆå¥½çš„ä½“éªŒ, ä¸ç”¨åœ¨ç†ä¼šçŠ¶æ€çš„æ±¡æŸ“é—®é¢˜, æ“ä½œçŠ¶æ€é—®é¢˜, è§†å›¾è®¢é˜…é—®é¢˜, å°±ç¼ºä¸€ä¸ªçŠ¶æ€å¯è§†åŒ–, æ²¡é”™è¿˜çœŸæœ‰è¿™ä¸ªåŠŸèƒ½, å¯ä»¥å°†æ›´æ”¹<code>state</code>å‰åçš„å˜åŒ–ä»¥åŠæ“ä½œçš„<code>action</code>éƒ½ç»™æµ®ç°å‡ºæ¥, åœ¨å†™ä¸­é—´ä»¶å‰, å…ˆæ¥ä¸€ä¸ªå°èœå‹å‹æƒŠ.</p> <h3 id="åŸæ±åŸå‘³çš„logger"><a href="#åŸæ±åŸå‘³çš„logger" class="header-anchor">#</a> åŸæ±åŸå‘³çš„logger</h3> <p>å…ˆæ¥ä¸€ä¸ªç®€å•åœ°<code>logger</code>è¯•è¯•æ°´, è¿˜æ˜¯å®Œå…¨OKçš„, è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„, é¦–å…ˆè¯´æ˜, åªèƒ½æ˜¯æ´¾å‘ä¸€ä¸ªç»„ä»¶çŠ¶æ€æ‰èƒ½ç”Ÿæ•ˆ, å¤šä¸ªåˆå¹¶çš„çŠ¶æ€å°±ä¼šGG, ä¹ä¸€çœ‹ä¹Ÿæ²¡ä»€ä¹ˆéš¾åº¦, æ¯æ¬¡ä¿®æ”¹çŠ¶æ€å°±ä¼šåœ¨æ§åˆ¶å°æ‰“å°å‡ºå¯¹åº”çš„çŠ¶æ€, ç¼ºç‚¹å°±æ˜¯æ²¡åŠæ³•çº§è”<span class="badge warn" style="vertical-align:top;" data-v-26ebd6a3>æ— é™å±‚æ¬¡åµŒå¥—ä¸­é—´ä»¶</span>å…¶ä»–ä¸­é—´ä»¶.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// createStore</span>
<span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> oldStore <span class="token operator">=</span> store<span class="token punctuation">.</span>dispatch
store<span class="token punctuation">.</span><span class="token function-variable function">dispatch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'%c prev state'</span><span class="token punctuation">,</span><span class="token string">'font:bold; color:gray'</span><span class="token punctuation">,</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'%c action'</span><span class="token punctuation">,</span><span class="token string">'font:bold; color:green'</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span>
    <span class="token function">oldStore</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'%c next state'</span><span class="token punctuation">,</span><span class="token string">'font:bold; color:blue'</span><span class="token punctuation">,</span> store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¾ˆæ˜æ˜¾å®Œå…¨æ— æ³•å¤ç”¨, ç®€ç›´çƒ‚çš„ä¸€å¡Œç³Šæ¶‚, æ¥ä¸‹æ¥å°è¯•å°†å…¶å°è£…åˆ°ä¸€ä¸ªå…¬å…±æ–¹æ³•ä¸­, æ³¨æ„, æ‰€æœ‰çš„ä¸­é—´ä»¶éƒ½æ˜¯ä¸€ä¸ªè‡ªæ‰§è¡Œçš„å‡½æ•°, å°†ä»“åº“<code>store</code>ä¸¢åˆ°å…¶ä¸­, æ‰§è¡Œè¿”å›å¦ä¸€ä¸ªå‡½æ•°ä»¥ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ä½œä¸ºå‚æ•°è¿”å›, è¯´èµ·æ¥æœ‰ç‚¹ç»•, çœ‹ä»£ç ä¼šæ¯”è¾ƒæ¸…æ™°.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>getState<span class="token punctuation">,</span>dispatch<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// æ­¤å¤„çš„nextå°±æ˜¯æ— æ³•å¤„ç†ç›´æ¥è¿”å›åˆ°ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æ¥å—å¤„ç†</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æ¥å—æ˜¯éœ€è¦æ‰§è¡Œçš„æ“ä½œ</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'%c prev state'</span><span class="token punctuation">,</span><span class="token string">'font:bold; color:gray'</span><span class="token punctuation">,</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'%c action'</span><span class="token punctuation">,</span><span class="token string">'font:bold; color:green'</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span>
            <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'%c next state'</span><span class="token punctuation">,</span><span class="token string">'font:bold; color:blue'</span><span class="token punctuation">,</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="çº§è”ä¸­é—´ä»¶-applymiddleware"><a href="#çº§è”ä¸­é—´ä»¶-applymiddleware" class="header-anchor">#</a> çº§è”ä¸­é—´ä»¶ applyMiddleware</h3> <p>ç»“æ„è¿˜æ˜¯æ¯”ä»·æ¸…æ™°çš„, åªè´Ÿè´£è‡ªå·±è¿™å—ä¸šåŠ¡, å…¶ä»–çš„ä¸šåŠ¡ç›´æ¥å¿½ç•¥è¿‡æ‰, ä½†æ˜¯è¿™æ ·ç”¨æ˜¯èƒ½ç”¨, è¿˜æ˜¯é‚£å¥è¯, åŠŸèƒ½å†™å‡ºæ¥äº†ä½†æ˜¯åªèƒ½ç”¨ä¸€ä¸ªå•Š, å…¶ä»–çš„å®Œå…¨ä¸èƒ½æ··ç”¨, é‚£è¿™ä¸ç­‰äºç™½æŠ˜è…¾, è¿™æ—¶å€™å°±è¦æƒ³åŠæ³•å°†æ‰€æœ‰çš„çŠ¶æ€æ“ä½œå…¨éƒ½ä¸²è”åˆ°ä¸€èµ·, åªä¸è¿‡åœ¨å¤„ç†æ‰€æœ‰é€»è¾‘ä¹‹å‰åŠ ä¸€ä¸ªè¿‡æ»¤å‡½æ•°, æ¥åˆ†è§£æ“ä½œ.***ä¸¾ä¾‹è¯´æ˜ï¼šæˆ‘ä»¬æœŸæœ›çš„æ˜¯æœ‰ä¸€ä¸ªå‡½æ•°å°†<code>logger</code>ä¼ å…¥æ‰§è¡Œ, ç„¶åå†å°†<code>createStore</code>ä¼ å…¥æ‰§è¡Œ,<code>...</code> æœ€åå†å°†<code>reducer</code>ä¼ å…¥, æœ€ç»ˆè¿”å›ä¸€ä¸ªä¿®æ”¹å®Œåçš„<code>store</code>ç…§å¸¸ä½¿ç”¨å³å¯.***, ç®€è€Œè¨€ä¹‹å°±æ˜¯éœ€è¦å°†æ‰€æœ‰çš„è¿‡æ»¤å™¨ç»“åˆåˆ°ä¸€èµ·ä½¿ç”¨.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>middlewares</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">createStore</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">reducer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span>
            <span class="token keyword">let</span> middlewareAPI <span class="token operator">=</span> <span class="token punctuation">{</span>                    ğŸš€
                getState<span class="token operator">:</span> store<span class="token punctuation">.</span>getState<span class="token punctuation">,</span>
                dispatch<span class="token operator">:</span> store<span class="token punctuation">.</span>dispatch
            <span class="token punctuation">}</span>
            middlewares <span class="token operator">=</span> <span class="token function">middlewares</span><span class="token punctuation">(</span>middlewareAPI<span class="token punctuation">)</span> ğŸš€
            dispatch <span class="token operator">=</span> <span class="token function">middlewares</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">)</span>   ğŸš€
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token operator">...</span>store<span class="token punctuation">,</span>
                dispatch
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸­é—´ä»¶çš„æ ¸å¿ƒå°±æ˜¯è¿­ä»£æ¯ä¸€ä¸ªè¿‡æ»¤å™¨, ç»“æ„è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„, å°†æ‰€æœ‰çš„ä¸­é—´ä»¶æ”¶å…¥å…¶ä¸­, åœ¨ä¼ å…¥åˆ°é€šè¿‡<code>createStore</code>åˆ›å»ºçš„<code>store</code>æ¥æ”¶, æ³¨æ„ç‚¹ï¼š<strong>å¸¦ğŸš€çš„éƒ¨åˆ†å°±æ˜¯ä¸­é—´ä»¶çš„æ‰§è¡Œæ–¹å¼</strong>,</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">logger</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> getState<span class="token punctuation">,</span> dispatch <span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'%c prev state'</span><span class="token punctuation">,</span> <span class="token string">'font:bold;color:gray'</span><span class="token punctuation">,</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'%c action'</span><span class="token punctuation">,</span> <span class="token string">'font:bold;color:green'</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span>
            <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'%c next state'</span><span class="token punctuation">,</span> <span class="token string">'font:bold;color:blue'</span><span class="token punctuation">,</span> <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç›®å‰æ¥è¯´å·²ç»æ˜¯å¯ä»¥ä½¿ç”¨äº†, ä½†æ˜¯åªèƒ½æ˜¯å•ä¸ªå•ä¸ªä¸­é—´ä»¶ä½¿ç”¨, ç±»å¦‚<code>let store = applyMiddleware(logger)(createStore)(reducer)</code>, å…¶ä¸­çš„<code>logger</code>å¯ä»¥éšæ„åˆ‡æ¢, ä½†è¿™æ˜æ˜¾ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„åœºæ™¯, æˆ‘ä»¬éœ€è¦å°†ä»–ä»¬ä¸²è”èµ·æ¥ä½¿ç”¨,</p> <h2 id="redux-thunk"><a href="#redux-thunk" class="header-anchor">#</a> redux-thunk <span class="badge tip" style="vertical-align:top;" data-v-26ebd6a3>éš¾åº¦ç³»æ•°ğŸŒŸğŸŒŸ</span></h2> <p>åœ¨çº§è”ä¸­é—´ä»¶ä¹‹å‰, æˆ‘ä»¬å…ˆè§£å†³å¦å¤–ä¸€ä¸ªé—®é¢˜, åœ¨å¼€å‘ä¸­ä¹Ÿè¾ƒä¸ºå¸¸è§, æ´¾å‘<code>action</code>çš„ç±»å‹, ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬çš„ç±»å‹æ“ä½œæ˜¯è¿™ç§</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token parameter">payload</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token constant">INTREMENT</span><span class="token punctuation">,</span> payload<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¤§æ¦‚æ„æ€å°±æ˜¯æ´¾å‘çš„å‡½æ•°ä½“ä¸­çš„ç±»å‹éƒ½æ˜¯ä¸º<code>Object</code>ç±»å‹, è¿™ä¹Ÿæ˜¯ä¸ºæˆ‘ä»¬çš„ç±»å‹åˆ¤æ–­åšäº†æ ¡éªŒ, å°½ç®¡è¿™æ ·å†™èµ·æ¥å¾ˆæ–¹ä¾¿,è¾¨è¯†åº¦é«˜, ä½†æ˜¯æ»¡è¶³ä¸äº†æˆ‘ä»¬çš„å¼€å‘éœ€æ±‚, ä¸¾ä¸€ä¸ªç®€å•çš„ğŸŒ°, æˆ‘éœ€è¦å»¶è¿Ÿæ´¾å‘æŸä¸ªåŠ¨ä½œ, å½“ç„¶å¦‚æœä½ éè¦ä½ å’‹æ‰§è¡Œçš„æ—¶å€™åŠ å…¥å»¶è¿Ÿ(æ²™é›•è¡Œä¸º, é‡æ„ç«è‘¬åœº), é‚£å’±ä¹Ÿæ²¡åŠæ³•.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">syncIncrement</span><span class="token punctuation">(</span><span class="token parameter">payload</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dispatch<span class="token punctuation">,</span>getState</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token constant">INTREMENT</span><span class="token punctuation">,</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">6666</span><span class="token punctuation">)</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ‘ä»¬æœŸæœ›çš„æ–¹å¼æ˜¯è¿™æ ·æ¥æ“ä½œ, è§£é‡Šä¸€ä¸‹, ç”±äºæ˜¯å»¶è¿Ÿæ“ä½œ, ä¸ºé€‚åº”ä¸­é—´ä»¶çš„æµç¨‹, æ‰€ä»¥è¿˜æ˜¯è€è§„çŸ©, ç”¨å‡½æ•°è¿”å›çš„æ–¹å¼æ¥æ´¾å‘, å½“ç„¶ç°åœ¨ç›´æ¥è¿è¡Œ, è‚¯å®šæ˜¯å›æŠ¥<code>æœŸæœ›å€¼æ˜¯Object</code>, æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸­é—´ä»¶æ¥è§„é¿è¿™ç§æ“ä½œ, é‡åˆ°è¿™ä¸­å‡½æ•°ç±»å‹çš„ç›´æ¥æ‰§è¡Œæ‰, ä¸ä¼šæµå…¥åˆ°å…¶ä»–æ–¹æ³•. ä¹‹å‰æåˆ°è¿‡ä¸­é—´ä»¶éƒ½æ˜¯åŒä¸€å¥—æµç¨‹, ä¸å¤šåºŸè¯ç›´æ¥ä¸Šä»£ç </p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">thunk</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>dispatch<span class="token punctuation">,</span>getState<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> action <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">action</span><span class="token punctuation">(</span>getState<span class="token punctuation">,</span>dispatch<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å’Œ<code>logger</code>æ²¡å¤šå¤§å·®åˆ«, å°±æ˜¯ä¸­é—´å±‚çš„æ“ä½œæœ‰äº›è®¸åŒºåˆ«, é‚£å°±ä¸åšè¿‡å¤šé˜è¿°, ä¸‹é¢æœ‰ä¸€ä¸ªæ›´åŠ æ¶å¿ƒçš„æ“ä½œ, å¦‚æœæˆ‘æ´¾å‘çš„ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹, è€Œæ˜¯åˆæ˜¯åŒ…è£…äº†ä¸€ä¸ªå»¶è¿Ÿæ´¾å‘çš„å‡½æ•°, å¦‚ä¸‹.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">syncIncrement</span><span class="token punctuation">(</span><span class="token parameter">payload</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dispatch<span class="token punctuation">,</span>getState</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dispatch<span class="token punctuation">,</span>getState</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span> <span class="token constant">INTREMENT</span><span class="token punctuation">,</span> payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">6666</span><span class="token punctuation">)</span> 
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">6666</span><span class="token punctuation">)</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æ”¹é€ ä¸­é—´ä»¶-applymiddleware"><a href="#æ”¹é€ ä¸­é—´ä»¶-applymiddleware" class="header-anchor">#</a> æ”¹é€ ä¸­é—´ä»¶ applyMiddleware</h3> <p>ä½ è¯´æ°”ä¸æ°”, è¿™æ ·ä¸€è¿è¡Œ, åˆæŠ¥é”™, ç¬¬äºŒæ¬¡æ´¾å‘çš„åŠ¨ä½œå°±ä¸ä¼šé‡æ–°è¿›ä¸­é—´ä»¶æµç¨‹, è€Œæ˜¯æ¥ç€æ´¾å‘, ç„¶åå†…éƒ¨åˆæ²¡æœ‰å¤„ç†æœºåˆ¶, æ‰€ä»¥å½’æ ¹ç»“åº•<code>dispatch</code>çš„å±æ€§æ˜¯ä¸ªå¤§éš¾é¢˜, ä¸èƒ½è¿”å›åŸç”Ÿçš„<code>dispatch</code>, è¿™æ ·å°±ä¸ä¼šé‡æ–°èµ°æµç¨‹, å¯¼è‡´æ— æ³•è§£å†³ä¸­é—´ä»¶é—®é¢˜, é‚£å°±æ¥æ”¹é€ ä¸€ä¸‹<code>applyMiddleware</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span><span class="token parameter">middleware</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">let</span> dispatch<span class="token punctuation">;</span>   ğŸš€
    <span class="token keyword">let</span> middlewareAPI <span class="token operator">=</span> <span class="token punctuation">{</span>
        getState<span class="token operator">:</span> store<span class="token punctuation">.</span>getState<span class="token punctuation">,</span>
        <span class="token function-variable function">dispatch</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> ğŸš€
    <span class="token punctuation">}</span>
    middleware <span class="token operator">=</span> <span class="token function">middleware</span><span class="token punctuation">(</span>createStore<span class="token punctuation">)</span>
    dispatch <span class="token operator">=</span> <span class="token function">middlewares</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">)</span> ğŸš€
<span class="token punctuation">}</span>
</code></pre></div><p>å°±ç¨å¾®æ”¹äº†ä¸‹å¸¦<code>ğŸš€</code>çš„åœ°æ–¹ è¿™ä¸ªéš¾é¢˜å°±è§£å†³äº†, å…ˆç”¨å˜é‡ç¼“å­˜ä¸€ä¸‹, è™½ç„¶ç¬¬ä¸€æ¬¡æ˜¯ç©º, ä½†æ˜¯æˆ‘å†…éƒ¨ä¸ä¼šè°ƒç”¨, æœ€åä¸€å¥æ˜¯è®©æ¯ä¸€æ¬¡æ´¾å‘çš„<code>dispatch</code>éƒ½æ˜¯ä¸Šä¸€æ¬¡åŒ…è£…è¿‡åçš„<code>dispatch</code> ä¸è‡³äºä¼šç•¥è¿‡ä¸­é—´ä»¶ç›´æ¥è¿›åˆ°ä¸‹ä¸€çº§.</p> <h2 id="redux-promise"><a href="#redux-promise" class="header-anchor">#</a> redux-promise <span class="badge tip" style="vertical-align:top;" data-v-26ebd6a3>éš¾åº¦ç³»æ•°ğŸŒŸğŸŒŸğŸŒŸ</span></h2> <p>æ¶å¿ƒçš„éœ€æ±‚ä»æ¥éƒ½åªæœ‰ç¬¬ä¸€æ¬¡å¾ˆæ— æ•°æ¬¡, å³<code>thunk</code>ä¸­é—´ä»¶ä¹‹ååˆä¸€ä¸ªæ¶å¿ƒçš„éœ€æ±‚, å¯èƒ½æ´¾å‘çš„åˆä¸æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹, å¯èƒ½åˆä¼šå­˜åœ¨<code>Promise</code>ç±»å‹çš„, å¥½å§, è¿™ä¸ªå…¶å®ä¹Ÿè¿˜å¥½, åœ¨å†™ä¹‹å‰å…ˆæƒ³å¥½ç­–ç•¥ã€‚ <strong>ä¸­é—´ä»¶,é‚£ä¹ˆç»“æ„è‚¯å®šæ˜¯å’Œ<code>thunk</code>æ²¡åŒºåˆ«, <code>Promise</code> ä¸ æ™®é€šå‡½æ•°çš„åŒºåˆ«å¥½åšè¡¨ç¤ºçš„é‚£å°±æ˜¯<code>then</code>å±æ€§æ²¡é”™äº†</strong>, é‚£å°±ä»è¿™ç‚¹å…¥æ‰‹.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">promise</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>dispatch<span class="token punctuation">,</span> getState<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">next</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>then <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> action<span class="token punctuation">.</span>then <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> action<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>dispatch<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token function">next</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="compose"><a href="#compose" class="header-anchor">#</a> compose <span class="badge warn" style="vertical-align:top;" data-v-26ebd6a3>éš¾åº¦ç³»æ•°ğŸŒŸğŸŒŸğŸŒŸ</span></h2> <p>å¥½åƒå•ä¸ªçš„ä¸­é—´ä»¶ç¼–å†™èµ·æ¥ä¹Ÿéƒ½è¿˜å¥½, æ²¡ä»€ä¹ˆè‡´å‘½éš¾åº¦, é‚£ä½ å°±é”™äº†, æœä¸å…¶ç„¶. ç°åœ¨æˆ‘ä»¬çš„ä¸­é—´ä»¶åªèƒ½å•ç‹¬ä½¿ç”¨, ç”¨ç¬¬ä¸€ä¸ªå°±ç”¨ä¸äº†ç¬¬äºŒä¸ª, é‚£ä¸æ˜¯å¾ˆè›‹ç–¼, å¾—æƒ³åŠæ³•å°†ä»–ä»¬éƒ½ç”¨èµ·æ¥, æœ€å¥½æ˜¯æƒ³æ•°ç»„çš„æ“ä½œä¸€æ ·, ç›´æ¥æŒ¨ä¸ªä¼ å…¥å³å¯, åœ¨ä½¿ç”¨ä¹‹å‰æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªé€’å½’çš„å‡½æ•°.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>fns</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>fns<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token parameter">args</span> <span class="token operator">=&gt;</span> args
    <span class="token keyword">if</span><span class="token punctuation">(</span>fns<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> fns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> fns<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>çœŸçš„ å°±ä¸€è¡Œä»£ç , çœŸçš„æ˜¯å¤©ç§€, è¿­ä»£æ–¹æ³•. èƒ½å°†æ–¹æ³•ç”±å†…è€Œå¤–çš„ä¼ å…¥æ‰§è¡Œ, ç½’Ï‰ç½’å·çœ‹æºç æ¥æ”¹çš„. è¿˜çœ‹ä¸æ‡‚<code>reduce</code>çš„çœŸçš„æ”¹å¥½å¥½è¡¥è¡¥åŸºç¡€äº†. æœ‰äº†è¿™ä¸ªå‡½æ•°, å°±å¯ä»¥æ¥æ”¹é€ <code>applyMiddleware</code>å®ç°ä¸­é—´ä»¶çº§è”ä½¿ç”¨äº†, ä¹Ÿä¸æ˜¯å¾ˆéš¾.</p> <h3 id="ç»ˆæä¸­é—´ä»¶-applymiddleware"><a href="#ç»ˆæä¸­é—´ä»¶-applymiddleware" class="header-anchor">#</a> ç»ˆæä¸­é—´ä»¶ applyMiddleware</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>middlewares</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">createStore</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">reducer</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span>
            <span class="token keyword">let</span> dispatch<span class="token punctuation">;</span>
            <span class="token keyword">let</span> middlewareAPI <span class="token operator">=</span> <span class="token punctuation">{</span>
                getState<span class="token operator">:</span> store<span class="token punctuation">.</span>getState<span class="token punctuation">,</span>
                <span class="token function-variable function">dispatch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            middlewares <span class="token operator">=</span> middlewares<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">middleware</span> <span class="token operator">=&gt;</span> <span class="token function">middleware</span><span class="token punctuation">(</span>middlewareAPI<span class="token punctuation">)</span><span class="token punctuation">)</span>
            dispatch <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span>middlewares<span class="token punctuation">)</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token operator">...</span>store<span class="token punctuation">,</span>
                dispatch
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åˆ°æ­¤ä¸ºæ­¢, å¸¸ç”¨ä¸­é—´ä»¶ç³»åˆ—, ç®—æ˜¯å‘Šä¸€æ®µè½, å…¶ä»–çš„ä¸­é—´ä»¶ä¹Ÿæœ‰ç¼–å†™, å°±ä¸åœ¨åšç´¯èµ˜, ç•™ä¸ªåœ°å€, æœ‰å…´è¶£è€…, å¯ç§»æ­¥</p> <p><strong>åœ°å€ï¼š<a href="https://github.com/StackFei/ReactFAQ" target="_blank" rel="noopener noreferrer">https://github.com/StackFei/ReactFAQ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°æ—¶é—´:</span> <span class="time">12/4/2019, 12:43:57 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/FAQ/React/react-redux.html" class="prev">
        ğŸreduxçš„é€šè®¯æ–¹å¼
      </a></span> <span class="next"><a href="/FAQ/React/Hooks.html">
        ğŸŠHooks
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.903983bb.js" defer></script><script src="/assets/js/2.c5c844f9.js" defer></script><script src="/assets/js/18.ceef7e7d.js" defer></script><script src="/assets/js/10.acc61093.js" defer></script>
  </body>
</html>
